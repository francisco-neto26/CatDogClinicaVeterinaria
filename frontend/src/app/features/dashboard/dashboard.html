<div class="surface-ground px-4 py-5 md:px-6 lg:px-8 min-h-screen">
    
    <div class="mb-5">
        <div class="text-3xl font-medium text-900 mb-3">Olá, {{ userName() }}</div>
        <div class="text-500">Bem-vindo ao painel do {{ role() === 'ROLE_CLIENTE' ? 'Tutor' : 'Administrador' }}.</div>
    </div>

    @if (loading()) {
        <div class="grid">
            <div class="col-12 md:col-4"><p-skeleton height="150px" /></div>
            <div class="col-12 md:col-4"><p-skeleton height="150px" /></div>
            <div class="col-12 md:col-4"><p-skeleton height="150px" /></div>
        </div>
    } @else {
        <div class="grid">
            
            <div class="col-12 md:col-6 lg:col-4">
                <div class="surface-card shadow-2 p-3 border-round h-full">
                    <div class="flex justify-content-between mb-3">
                        <div>
                            <span class="block text-500 font-medium mb-3">Consultas Agendadas</span>
                            <div class="text-900 font-medium text-xl">{{ totalAgendamentos() }}</div>
                        </div>
                        <div class="flex align-items-center justify-content-center bg-blue-100 border-round" style="width:2.5rem;height:2.5rem">
                            <i class="pi pi-calendar text-blue-500 text-xl"></i>
                        </div>
                    </div>
                    <span class="text-500">Próxima: </span>
                    <span class="text-green-500 font-medium">
                        {{ proximosAgendamentos().length ? (proximosAgendamentos()[0].dataHora | date:'dd/MM HH:mm') : 'Nenhuma' }}
                    </span>
                </div>
            </div>

            <div class="col-12 md:col-6 lg:col-4">
                <div class="surface-card shadow-2 p-3 border-round h-full">
                    <div class="flex justify-content-between mb-3">
                        <div>
                            <span class="block text-500 font-medium mb-3">
                                {{ role() === 'ROLE_CLIENTE' ? 'A Pagar' : 'A Receber' }}
                            </span>
                            <div class="text-900 font-medium text-xl">{{ valorFinanceiro() | currency:'BRL' }}</div>
                        </div>
                        <div class="flex align-items-center justify-content-center bg-green-100 border-round" style="width:2.5rem;height:2.5rem">
                            <i class="pi pi-money-bill text-green-500 text-xl"></i>
                        </div>
                    </div>
                    <span class="text-500">Valor Pendente</span>
                </div>
            </div>

            <div class="col-12 md:col-6 lg:col-4">
                 @if (role() === 'ROLE_CLIENTE') {
                    <div class="surface-card shadow-2 p-3 border-round h-full cursor-pointer hover:surface-hover transition-duration-200" routerLink="/novo-agendamento">
                        <div class="flex justify-content-between mb-3">
                            <div>
                                <span class="block text-500 font-medium mb-3">Precisa de ajuda?</span>
                                <div class="text-900 font-medium text-xl">Agendar Consulta</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-orange-100 border-round" style="width:2.5rem;height:2.5rem">
                                <i class="pi pi-plus text-orange-500 text-xl"></i>
                            </div>
                        </div>
                        <span class="text-blue-500">Clique para iniciar</span>
                    </div>
                } @else {
                    <div class="surface-card shadow-2 p-3 border-round h-full">
                        <div class="flex justify-content-between mb-3">
                            <div>
                                <span class="block text-500 font-medium mb-3">Em Atendimento</span>
                                <div class="text-900 font-medium text-xl">{{ totalContasAbertas() }}</div>
                            </div>
                            <div class="flex align-items-center justify-content-center bg-purple-100 border-round" style="width:2.5rem;height:2.5rem">
                                <i class="pi pi-folder-open text-purple-500 text-xl"></i>
                            </div>
                        </div>
                        <span class="text-500">Contas Abertas</span>
                    </div>
                }
            </div>

            <div class="col-12">
                <div class="surface-card shadow-2 border-round p-4">
                    <div class="flex align-items-center justify-content-between mb-4">
                        <span class="text-xl font-medium text-900">Próximos Agendamentos</span>
                        <p-button icon="pi pi-arrow-right" [text]="true" label="Ver todos" [routerLink]="role() === 'ROLE_CLIENTE' ? '/meus-agendamentos' : '/agendamentos'" />
                    </div>
                    <ul class="p-0 m-0 list-none">
                        @for (item of proximosAgendamentos(); track item.id) {
                            <li class="flex align-items-center py-3 border-bottom-1 surface-border">
                                <div class="w-3rem h-3rem flex align-items-center justify-content-center bg-blue-100 border-circle mr-3 flex-shrink-0">
                                    <i class="pi pi-calendar text-xl text-blue-500"></i>
                                </div>
                                <span class="text-900 line-height-3 font-bold mb-0 block flex-grow-1">
                                    {{ item.dataHora | date:'dd/MM HH:mm' }}
                                    <span class="text-500 font-normal block text-sm">Animal ID: {{ item.animalId }}</span>
                                </span>
                                <span class="px-2 py-1 border-round text-sm" 
                                      [ngClass]="{'bg-green-100 text-green-600': item.status === 'CONCLUIDO', 'bg-blue-100 text-blue-600': item.status === 'AGENDADO'}">
                                    {{ item.status }}
                                </span>
                            </li>
                        }
                        @if (proximosAgendamentos().length === 0) {
                            <li class="text-center p-3 text-500">Nenhum agendamento futuro.</li>
                        }
                    </ul>
                </div>
            </div>
        </div>
    }
</div>